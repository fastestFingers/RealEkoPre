import{_ as P,l as _,Q as R,m as n,n as d,p as l,U as S,f as r,s as o,q as u,a6 as C,az as m,F as v,X as p,a5 as O,Y as c,S as i,ab as V,ac as k,bz as E,as as x,t as f}from"./index.9793c43f.js";import{Q as T}from"./QToolbarTitle.1f40af49.js";import{Q as U}from"./QToolbar.76ca8ca1.js";import{Q as M}from"./QHeader.3cfb9d75.js";import{Q as z}from"./QImg.51839b12.js";import{Q as L}from"./QList.f278e53f.js";import{Q as B}from"./QPage.dcf44012.js";import{Q as N}from"./QPullToRefresh.3943d5c2.js";import{Q as Y}from"./QInnerLoading.9a29075c.js";import{Q as j}from"./QFooter.b1186792.js";import{u as F}from"./CartStore.e08e1718.js";import{u as H}from"./DeliverySched.51e51dc1.js";import"./QResizeObserver.d4331a6a.js";import"./touch.9135741d.js";import"./selection.f40087f4.js";import"./format.8ac60962.js";const J={name:"CartPage",components:{CartMerchantInfo:_(()=>f(()=>import("./CartMerchantInfo.0be34a98.js"),["assets/CartMerchantInfo.0be34a98.js","assets/index.9793c43f.js","assets/index.661bbb30.css","assets/QImg.51839b12.js","assets/CartStore.e08e1718.js"])),CartDetails:_(()=>f(()=>import("./CartDetails.8428bfa9.js"),["assets/CartDetails.8428bfa9.js","assets/index.9793c43f.js","assets/index.661bbb30.css","assets/QSkeleton.6e239cc5.js","assets/QList.f278e53f.js","assets/QImg.51839b12.js","assets/QItemLabel.eca1584d.js","assets/QSlideItem.c63f5dd7.js","assets/QPullToRefresh.3943d5c2.js","assets/touch.9135741d.js","assets/selection.f40087f4.js","assets/format.8ac60962.js","assets/use-render-cache.3aae9b27.js","assets/CartStore.e08e1718.js"])),DeliveryDetails:_(()=>f(()=>import("./DeliveryDetails.810f3594.js"),["assets/DeliveryDetails.810f3594.js","assets/index.9793c43f.js","assets/index.661bbb30.css","assets/QBtnToggle.3250107e.js","assets/QBtnGroup.0b2a69a0.js","assets/QItemLabel.eca1584d.js","assets/QList.f278e53f.js","assets/PlaceStore.9f90f8e0.js","assets/DeliverySched.51e51dc1.js"])),DeliverySched:_(()=>f(()=>import("./DeliverySched.e03cbf21.js"),["assets/DeliverySched.e03cbf21.js","assets/QBtnToggle.3250107e.js","assets/index.9793c43f.js","assets/index.661bbb30.css","assets/QBtnGroup.0b2a69a0.js","assets/QSelect.06fcbf11.js","assets/QChip.82264df0.js","assets/QItemLabel.eca1584d.js","assets/QMenu.e8b690c9.js","assets/selection.f40087f4.js","assets/rtl.276c3f1b.js","assets/format.8ac60962.js","assets/DeliverySched.51e51dc1.js"])),SimilarItems:_(()=>f(()=>import("./SimilarItems.1a3d9a38.js"),["assets/SimilarItems.1a3d9a38.js","assets/swiper.min.b39a1361.css","assets/index.9793c43f.js","assets/index.661bbb30.css","assets/QSkeleton.6e239cc5.js","assets/QImg.51839b12.js","assets/CartStore.e08e1718.js","assets/MenuStore.ade9d645.js","assets/swiper-slide.48402cb7.js"])),ComponentsRealtime:_(()=>f(()=>import("./ComponentsRealtime.8bb7297a.js"),["assets/ComponentsRealtime.8bb7297a.js","assets/index.4f152a18.js","assets/index.9793c43f.js","assets/index.661bbb30.css"]))},data(){return{payload:["items","subtotal","distance_local","items_count","merchant_info","check_opening","transaction_info"],back_url:"/cart?refresh=1",lastPath:"",data_slide:{},include_utensils:!1}},setup(){const e=F(),a=H(),h=R();return{CartStore:e,DeliveryschedStore:a,DataStore:h}},created(){this.CartStore.getCart(!0,this.payload);const e=n.getStorage("include_utensils");n.empty(e)||(this.include_utensils=e),this.DeliveryschedStore.getDeliverySched(n.getStorage("cart_uuid"),n.getStorage("merchant_slug"),"cart")},mounted(){this.lastPath=this.$router.options.history.state.back},computed:{getMerchantUUID(){return Object.keys(this.CartStore.cart_merchant).length>0?this.CartStore.cart_merchant.merchant_uuid:!1}},methods:{backPage(){this.lastPath.search("map")>0?this.$router.push({name:"menu",params:{slug:this.CartStore.cart_merchant.slug}}):this.$router.back()},afterSavetrans(){this.CartStore.getCart(!1,this.payload),console.log("afterSavetrans"),this.DeliveryschedStore.getDeliverySched(n.getStorage("cart_uuid"),n.getStorage("merchant_slug"))},afterSavetranstype(){this.CartStore.getCart(!1,this.payload)},onClickchange(){this.$refs.delivery_details.showModal(!0)},showSched(){this.$refs.delivery_details.showModal(!1),this.$refs.delivery_sched.showSched(!0)},onRight(e,a){this.data_slide[a]=e},closeSlide(e){this.data_slide[e]&&this.data_slide[e].reset()},setUtensil(e){n.setStorage("include_utensils",e)},refresh(e){this.CartStore.getCart(!1,this.payload),e()},checkBeforeCheckout(){if(console.log(this.CartStore.transaction_info.whento_deliver),this.CartStore.transaction_info.whento_deliver=="schedule"){let e="You are placing and order for {date} at {time}. Would you like to continue?";e=e.replace("{date}",this.CartStore.transaction_info.delivery_date_pretty),e=e.replace("{time}",this.CartStore.transaction_info.delivery_time.pretty_time),this.$q.dialog({title:"Ordering for later?",message:e,persistent:!0,position:"standard",transitionShow:"fade",transitionHide:"fade",ok:{unelevated:!0,color:"primary",rounded:!1,"text-color":"white",size:"md",label:"Continue","no-caps":!0},cancel:{unelevated:!0,rounded:!1,color:"grey-3","text-color":"black",size:"md",label:"Cancel","no-caps":!0}}).onOk(()=>{this.$router.push("/checkout")}).onOk(()=>{}).onCancel(()=>{}).onDismiss(()=>{})}else this.$router.push("/checkout")},afterSetplaceid(){this.CartStore.getCart(!0,this.payload)},afterReceive(e){console.log("afterReceive"),console.log(e);let a=JSON.parse(e.message);console.log(a),n.fetchDataPost("validateCartItems","item_id="+a.item_id+"&cart_uuid="+n.getStorage("cart_uuid")).then(h=>{this.$q.dialog({title:this.$t("Items"),message:h.msg,persistent:!0}).onOk(()=>{this.CartStore.getCart(!0,this.payload)}).onCancel(()=>{}).onDismiss(()=>{})}).catch(h=>{}).then(h=>{})}}},W={key:0,class:"text-center full-width"},X={class:"text-h5 text-weight-bold"},G={class:"text-grey font12"},K={key:0,class:"q-pl-md q-pr-md"},Z={class:"text-weight-bold font16"},$={class:"text-grey"},ee={class:"row justify-end"},te={class:"q-pl-sm"},re={class:"row items-center justify-between fit"},ae={class:"text-weight-bold font17"},oe={class:"text-weight-bold font16"};function se(e,a,h,t,g,s){const b=d("CartMerchantInfo"),D=d("CartDetails"),w=d("SimilarItems"),I=d("DIV"),Q=d("DeliveryDetails"),q=d("DeliverySched"),A=d("ComponentsRealtime");return l(),S(v,null,[r(N,{onRefresh:s.refresh},{default:o(()=>[r(M,{reveal:"","reveal-offset":"10",class:C({"bg-mydark text-white":e.$q.dark.mode,"bg-white text-black":!e.$q.dark.mode})},{default:o(()=>[r(U,null,{default:o(()=>[r(p,{onClick:a[0]||(a[0]=y=>e.$router.back()),flat:"",round:"",dense:"",icon:"las la-angle-left",class:"q-mr-sm",color:e.$q.dark.mode?"white":"dark"},null,8,["color"]),r(T,{class:"text-weight-bold"},{default:o(()=>[O(c(e.$t("Your Order")),1)]),_:1}),t.CartStore.hasItem?(l(),u(p,{key:0,onClick:a[1]||(a[1]=y=>this.$refs.cart_details.clearCart()),flat:"",round:"",dense:"",icon:"las la-trash-alt",color:"secondary"})):m("",!0)]),_:1})]),_:1},8,["class"]),r(B,null,{default:o(()=>[!t.CartStore.hasItem&&!t.CartStore.cart_loading?(l(),S("div",W,[r(z,{src:"cart-empty.png",fit:"fill","spinner-color":"primary",style:{height:"80px","max-width":"80px"}}),i("div",X,c(e.$t("Your cart is empty")),1),i("p",G,c(e.$t("You don't have any orders here! let's change that!")),1)])):(l(),S(v,{key:1},[r(b,{ref:"cart_merchantinfo",show_transinfo:!0,onOnClickchange:s.onClickchange},null,8,["onOnClickchange"]),!t.CartStore.canProceed&&!t.CartStore.cart_loading?(l(),S("div",K,[i("div",{class:C(["q-pa-md radius8 font12",{"bg-grey600 text-grey300":e.$q.dark.mode,"bg-yellow text-dark":!e.$q.dark.mode}]),style:{bottom:"51px"}},c(t.CartStore.getErrorMsg),3)])):m("",!0),r(D,{ref:"cart_details",is_checkout:!0,payload:g.payload},null,8,["payload"]),!t.CartStore.cart_loading&&t.DataStore.enabled_include_utensils?(l(),u(L,{key:1,class:"border-grey-top"},{default:o(()=>[r(V,null,{default:o(()=>[r(k,null,{default:o(()=>[i("div",Z,c(e.$t("Cutlery")),1),i("div",$,c(e.$t("Include utensils, napkins, etc.")),1)]),_:1}),r(k,{side:""},{default:o(()=>[r(E,{modelValue:g.include_utensils,"onUpdate:modelValue":[a[2]||(a[2]=y=>g.include_utensils=y),s.setUtensil]},null,8,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1})]),_:1})):m("",!0),t.CartStore.hasItem?(l(),u(I,{key:2,class:"q-pl-md q-pr-md border-grey-top"},{default:o(()=>[i("div",ee,[r(p,{unelevated:"",color:e.$q.dark.mode?"grey600":"mygrey","text-color":e.$q.dark.mode?"grey300":"grey","no-caps":"",size:"md",class:"radius8 q-mt-sm q-mb-md",to:{name:"menu",params:{slug:t.CartStore.cart_merchant.slug}}},{default:o(()=>[r(x,{name:"las la-plus",size:"15px"}),i("div",te,c(e.$t("Add more items")),1)]),_:1},8,["color","text-color","to"])]),t.CartStore.cart_merchant.merchant_id?(l(),u(w,{key:0,ref:"similar_items",title:e.$t("Most Ordered Items"),merchant_id:t.CartStore.cart_merchant.merchant_id},null,8,["title","merchant_id"])):m("",!0)]),_:1})):m("",!0)],64))]),_:1})]),_:1},8,["onRefresh"]),r(Y,{showing:t.CartStore.cart_reloading,color:"primary",size:"md","label-class":"dark"},null,8,["showing"]),t.CartStore.items_count>0?(l(),u(j,{key:0,reveal:"",class:C(["q-pl-md q-pr-md q-pb-sm q-pt-sm text-dark",{"bg-primary":!t.CartStore.cart_reloading,"bg-grey-5":t.CartStore.cart_reloading}])},{default:o(()=>[r(p,{onClick:s.checkBeforeCheckout,loading:t.CartStore.cart_loading,disable:!t.CartStore.canProceed,unelevated:"","text-color":"white","no-caps":"",class:"radius10 fit",color:{primary:!t.CartStore.cart_reloading,"grey-5":t.CartStore.cart_reloading}},{default:o(()=>[i("div",re,[i("div",ae,c(e.$t("Checkout")),1),i("div",oe,c(t.CartStore.cart_subtotal.value),1)])]),_:1},8,["onClick","loading","disable","color"])]),_:1},8,["class"])):m("",!0),r(Q,{ref:"delivery_details",back_url:g.back_url,onShowSched:s.showSched,onAfterSavetrans:s.afterSavetrans,onAfterSavetranstype:s.afterSavetranstype,onAfterSetplaceid:s.afterSetplaceid},null,8,["back_url","onShowSched","onAfterSavetrans","onAfterSavetranstype","onAfterSetplaceid"]),r(q,{ref:"delivery_sched",slug:t.CartStore.cart_merchant.slug,onAfterSavetrans:s.afterSavetrans},null,8,["slug","onAfterSavetrans"]),s.getMerchantUUID?(l(),u(A,{key:1,ref:"realtime",getevent:"cart",subscribe_to:s.getMerchantUUID,onAfterReceive:s.afterReceive},null,8,["subscribe_to","onAfterReceive"])):m("",!0)],64)}var ke=P(J,[["render",se]]);export{ke as default};
