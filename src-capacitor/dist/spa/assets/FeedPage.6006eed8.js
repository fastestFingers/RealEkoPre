import{_ as I,l as h,Q as M,m as c,av as P,n as u,p as i,q as f,s as n,f as r,X as k,U as a,a5 as p,Y as _,F as l,az as C,a6 as D,S,as as w,V as q,t as y,a9 as R,aa as E,ab as V,aE as z}from"./index.f7d559c9.js";import{Q as N}from"./QToolbarTitle.bdcd688d.js";import{Q as O}from"./QToolbar.e8bab0fc.js";import{Q as B}from"./QHeader.26b1a527.js";import{Q as $}from"./QSkeleton.d808f021.js";import{Q as j}from"./QList.559a09ed.js";import{Q as H}from"./QSpinnerDots.5f3befe4.js";import{Q as U}from"./QInfiniteScroll.db73a65e.js";import{Q as X}from"./QPage.026453a2.js";import{Q as Y}from"./QPullToRefresh.17afb92d.js";import{u as G}from"./CartStore.42bb2db8.js";import"./QResizeObserver.fad9f3e9.js";import"./touch.49a2039d.js";import"./selection.4a59aca4.js";import"./format.68d15b11.js";const J={name:"FeedPage",components:{MerchantListInline:h(()=>y(()=>import("./MerchantListInline.cc0036f5.js"),["assets/MerchantListInline.cc0036f5.js","assets/index.f7d559c9.js","assets/index.661bbb30.css","assets/QImg.04a8fde6.js","assets/QChip.75be2f9e.js","assets/QItemLabel.4e494c2c.js"])),MerchantListTpl:h(()=>y(()=>import("./MerchantListTpl.aea747fe.js"),["assets/MerchantListTpl.aea747fe.js","assets/index.f7d559c9.js","assets/index.661bbb30.css","assets/QImg.04a8fde6.js","assets/QChip.75be2f9e.js"])),MerchantListSkeleton:h(()=>y(()=>import("./MerchantListSkeleton.6262ed88.js"),["assets/MerchantListSkeleton.6262ed88.js","assets/QSkeleton.d808f021.js","assets/index.f7d559c9.js","assets/index.661bbb30.css","assets/QList.559a09ed.js"])),SortList:h(()=>y(()=>import("./SortList.34d224e2.js"),["assets/SortList.34d224e2.js","assets/QItemLabel.4e494c2c.js","assets/index.f7d559c9.js","assets/index.661bbb30.css","assets/QList.559a09ed.js"])),MerchantFilter:h(()=>y(()=>import("./MerchantFilter.502998c0.js"),["assets/MerchantFilter.502998c0.js","assets/QToolbarTitle.bdcd688d.js","assets/index.f7d559c9.js","assets/index.661bbb30.css","assets/QSpace.cb165838.js","assets/QToolbar.e8bab0fc.js","assets/QBtnToggle.b8808e61.js","assets/QBtnGroup.73e707aa.js","assets/QPullToRefresh.17afb92d.js","assets/touch.49a2039d.js","assets/selection.4a59aca4.js","assets/format.68d15b11.js","assets/QFooter.2200c75f.js","assets/QResizeObserver.fad9f3e9.js","assets/DeliverySched.5943bd48.js"])),NoResults:h(()=>y(()=>import("./NoResults.8164bd6f.js"),["assets/NoResults.8164bd6f.js","assets/QImg.04a8fde6.js","assets/index.f7d559c9.js","assets/index.661bbb30.css"]))},data(){return{loading:!0,list_type:"",featured_id:"",data:[],cuisine:[],reviews:[],estimation:[],services:[],items_min_max:[],title:"",page:0,sort_by:"",total_found:0,filters:[],transactionType:"",menu_type:"column",cuisine_id:"",cuisine_name:"",page_title:"",promos:[],payload:["cuisine","reviews","estimation","services","items_min_max","offers","promo"]}},setup(){const e=G(),o=M();return{CartStore:e,DataStore:o}},watch:{menu_type(e,o){console.log(e),c.setStorage("listType",e)}},created(){this.transactionType=c.getStorage("transaction_type"),this.list_type=this.$route.query.query,this.featured_id=this.$route.query.featured_id,this.cuisine_id=this.$route.query.cuisine_id,this.cuisine_name=this.$route.query.cuisine_name,this.page_title=this.$route.query.page_title,this.cuisine_id>0&&(this.filters={cuisine:[this.cuisine_id]});let e=c.getStorage("listType");c.empty(e)||(this.menu_type=e),Object.keys(this.DataStore.featured_data).length<=0&&this.DataStore.getFeaturedList(),this.DataStore.hasDataCuisine()||this.DataStore.CuisineList()},computed:{hasData(){return this.data.length>0},switchIconList(){return this.menu_type=="list"?"grid_view":"reorder"}},methods:{refresh(e){e(),this.resetPagination()},getMerchantFeed(e,o){const g={list_type:this.list_type,featured_id:this.featured_id,place_id:c.getStorage("place_id"),payload:this.payload,page:e,sort_by:this.sort_by,filters:this.filters};this.list_type==="featured"&&(g.featured_id=this.featured_id),this.loading=!0,P.authenticated()?c.fetchDataByToken("getMerchantFeed2",g).then(t=>{this.page=e,t.code==1?(this.data.push(t.details.data),this.cuisine=t.details.cuisine,this.reviews=t.details.reviews,this.estimation=t.details.estimation,this.services=t.details.services,this.items_min_max=t.details.items_min_max,this.total_found=t.details.total_found,this.promos=t.details.promos):(this.total_found=t.details.total_found,this.$refs.nscroll&&this.$refs.nscroll.stop())}).catch(t=>{this.$refs.nscroll&&this.$refs.nscroll.stop(),this.total_found=0}).then(t=>{this.loading=!1,o()}):c.getMerchantFeed(g).then(t=>{this.page=e,t.code==1?(this.data.push(t.details.data),this.cuisine=t.details.cuisine,this.reviews=t.details.reviews,this.estimation=t.details.estimation,this.services=t.details.services,this.items_min_max=t.details.items_min_max,this.total_found=t.details.total_found,this.promos=t.details.promos):(this.total_found=t.details.total_found,this.$refs.nscroll&&this.$refs.nscroll.stop())}).catch(t=>{this.$refs.nscroll&&this.$refs.nscroll.stop(),this.total_found=0}).then(t=>{this.loading=!1,o()})},afterSelectsort(e){console.log("afterSelectsort=>"+e),this.sort_by=e,this.resetPagination(),this.page=0},applyFilter(e){this.filters=e,this.filters.transaction_type=this.transactionType,this.resetPagination(),this.page=0},resetPagination(){this.page=0,this.data=[],this.$refs.nscroll.reset(),this.$refs.nscroll.resume(),this.$refs.nscroll.trigger()},filterAgain(){console.log("filterAgain"),this.$refs.merchant_filter.filter=!0}}},K={class:"row items-center justify-between no-wrap"},W={class:"row items-center no-wrap full-width"},Z={class:"text-center q-pr-sm"},ee={key:0,class:"text-grey q-pt-sm q-pb-xs"},te={key:1,class:"row justify-center absolute-bottom"};function se(e,o,g,t,s,m){const L=u("NoResults"),x=u("DIV"),Q=u("MerchantListInline"),F=u("MerchantListTpl"),T=u("MerchantListSkeleton"),b=u("SortList"),A=u("MerchantFilter");return i(),f(Y,{onRefresh:m.refresh},{default:n(()=>[r(B,{reveal:"","reveal-offset":"50",class:D({"bg-mydark text-white":e.$q.dark.mode,"bg-white text-dark":!e.$q.dark.mode})},{default:n(()=>[r(O,null,{default:n(()=>[r(k,{onClick:o[0]||(o[0]=d=>e.$router.back()),flat:"",round:"",dense:"",icon:"las la-angle-left",class:"q-mr-sm",color:e.$q.dark.mode?"white":"dark"},null,8,["color"]),r(N,{class:"text-weight-bold"},{default:n(()=>[t.DataStore.featured_data[this.featured_id]?(i(),a(l,{key:0},[p(_(t.DataStore.featured_data[this.featured_id]),1)],64)):s.cuisine_name?(i(),a(l,{key:1},[p(_(s.cuisine_name),1)],64)):s.page_title?(i(),a(l,{key:2},[p(_(s.page_title),1)],64)):C("",!0)]),_:1})]),_:1})]),_:1},8,["class"]),r(X,{padding:""},{default:n(()=>[r(x,{class:"q-pl-md q-pr-md"},{default:n(()=>[S("div",K,[r(k,{color:e.$q.dark.mode?"grey600":"mygrey","text-color":e.$q.dark.mode?"grey300":"dark","icon-size":"11px",unelevated:"","no-caps":"",size:"md",class:"radius10",onClick:o[1]||(o[1]=d=>this.$refs.sort_list.show_modal=!0)},{default:n(()=>[S("div",W,[S("div",Z,[t.DataStore.sort_list[s.sort_by]?(i(),a(l,{key:0},[p(_(t.DataStore.sort_list[s.sort_by]),1)],64)):(i(),a(l,{key:1},[p(_(e.$t("Sort")),1)],64))]),r(w,{name:"las la-angle-down",size:"15px"})])]),_:1},8,["color","text-color"]),S("div",null,[r(k,{color:e.$q.dark.mode?"grey600":"mygrey","text-color":e.$q.dark.mode?"grey300":"dark",unelevated:"","no-caps":"",round:"",size:"12px",class:"q-mr-sm",onClick:o[2]||(o[2]=d=>this.menu_type=this.menu_type=="list"?"column":"list")},{default:n(()=>[r(w,{name:m.switchIconList},null,8,["name"])]),_:1},8,["color","text-color"]),r(k,{color:e.$q.dark.mode?"grey600":"mygrey","text-color":e.$q.dark.mode?"grey300":"dark",unelevated:"","no-caps":"",round:"",size:"12px",onClick:o[3]||(o[3]=d=>this.$refs.merchant_filter.filter=!0)},{default:n(()=>[r(w,{name:"tune"})]),_:1},8,["color","text-color"])])]),s.loading&&s.page<=0?(i(),a("div",ee,[r($,{type:"text",style:{width:"100px"}})])):(i(),a("div",{key:1,class:D(["text-grey q-pt-sm q-pb-xs",{"min-height-inherit flex flex-center q-pa-none":!m.hasData}])},[m.hasData?(i(),a(l,{key:0},[p(_(s.total_found)+" "+_(e.$t("restaurant")),1)],64)):(i(),f(L,{key:1,onFilterAgain:m.filterAgain},null,8,["onFilterAgain"]))],2))]),_:1}),r(U,{ref:"nscroll",onLoad:m.getMerchantFeed,offset:250},{loading:n(()=>[s.page<=0?(i(),f(T,{key:0})):(i(),a("div",te,[r(H,{color:"secondary",size:"40px"})]))]),default:n(()=>[r(j,{class:"no-wrap"},{default:n(()=>[(i(!0),a(l,null,q(s.data,d=>(i(),a(l,{key:d},[(i(!0),a(l,null,q(d,v=>R((i(),f(V,{key:v.merchant_id,clickable:"",onClick:z(ie=>this.$router.push({name:"menu",params:{slug:v.restaurant_slug}}),["stop"])},{default:n(()=>[s.menu_type==="list"?(i(),f(Q,{key:0,items:v,cuisine:s.cuisine,reviews:s.reviews,estimation:s.estimation,services:s.services,items_min_max:s.items_min_max,promos:s.promos},null,8,["items","cuisine","reviews","estimation","services","items_min_max","promos"])):(i(),f(F,{key:1,items:v,cuisine:s.cuisine,reviews:s.reviews,estimation:s.estimation,services:s.services,items_min_max:s.items_min_max,promos:s.promos},null,8,["items","cuisine","reviews","estimation","services","items_min_max","promos"]))]),_:2},1032,["onClick"])),[[E]])),128))],64))),128))]),_:1})]),_:1},8,["onLoad"]),r(b,{ref:"sort_list",onAfterSelectsort:m.afterSelectsort},null,8,["onAfterSelectsort"]),r(A,{ref:"merchant_filter",cuisine_data:t.DataStore.cuisine,onApplyFilter:m.applyFilter,onRunFilter:e.runFilter},null,8,["cuisine_data","onApplyFilter","onRunFilter"])]),_:1})]),_:1},8,["onRefresh"])}var ve=I(J,[["render",se]]);export{ve as default};
